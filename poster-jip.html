<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>COPPER Fixed Ratio 60x90 Poster - Dynamic Layout</title>
    <!-- Load html2canvas for PNG download -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;900&display=swap" rel="stylesheet">
    <!-- Load Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">

    <style>
        /* Base styles */
        body { 
            font-family: 'Inter', sans-serif; 
            background-color: #E6EEF3; 
            color: #003B46; 
            line-height: 1.4; 
        }

        /* --- 60:90 Aspect Ratio Styling (2:3) --- */
        .poster-wrapper {
            margin: 1.5rem auto; 
            max-width: 900px; 
            width: 90%; 
            box-shadow: 0 10px 30px rgba(0, 59, 70, 0.2);
            background-color: white; 
        }
        
        /* VISUAL DISPLAY: Elemen ini memiliki dimensi 60x90 (2:3) di layar */
        .ratio-box {
            position: relative;
            width: 100%;
            /* Padding hack: 90 / 60 = 1.5. Sets height to 150% of the width. */
            padding-bottom: 150%; 
        }

        /* Konten di dalam ratio-box, yang mengisi seluruh area poster. */
        #poster-content { 
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            /* Penting: overflow-y: auto memungkinkan scrolling jika konten melebihi batas 60:90 */
            overflow-y: auto; 
            overflow-x: hidden; 
            background-color: white; 
        }
        
        /* Ensures internal padding is proportional to the poster size */
        .internal-padding {
            padding: 1.75rem 2rem; 
        }
        
        @media (max-width: 640px) {
             /* Adjusted padding for smaller screens */
            .internal-padding {
                padding: 1rem 1.25rem;
            }
        }
        
        .header-bg {
            background-color: #C4DFE6; 
            background-image: linear-gradient(to right, #C4DFE6, #66A5AD);
            position: relative;
            overflow: hidden;
            border-bottom-left-radius: 30px; 
            border-bottom-right-radius: 30px;
        }
        
        /* Flow Circle Styling (Used for vertical flow) */
        .flow-circle {
            width: 2.5rem; height: 2.5rem;
            border-radius: 9999px;
            display: flex; align-items: center; justify-content: center;
            font-weight: 900; font-size: 0.8rem;
            color: white;
            box-shadow: 0 4px 8px rgba(0, 59, 70, 0.2);
            margin-right: 0.75rem;
            flex-shrink: 0;
        }
        
        .c1 { background-color: #003B46; } 
        .c2 { background-color: #07575B; } 
        .c3 { background-color: #66A5AD; } 
        .c4 { background-color: #F7B733; } 

        .quote-box { border-left: 5px solid #F7B733; padding-left: 1rem; }
        
        /* Loading indicator styling (hidden by default) */
        #loading-indicator {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(255, 255, 255, 0.9);
            display: none; /* Controlled by JS */
            align-items: center;
            justify-content: center;
            flex-direction: column;
            z-index: 1000;
            font-size: 1.2rem;
            color: #003B46;
            text-align: center;
        }
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #F7B733;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin-bottom: 10px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
    </style>
</head>
<body class="selection:bg-[#F7B733] selection:text-[#003B46]">
    
    <!-- Loading Indicator -->
    <div id="loading-indicator">
        <div class="spinner"></div>
        <p class="font-bold">Mempersiapkan Poster...</p>
        <p class="text-sm">Menunggu semua gambar dimuat (termasuk logo) untuk resolusi cetak 60x90 cm.</p>
    </div>

    <!-- Main wrapper to enforce max-width and centering -->
    <div id="poster-wrapper-id" class="poster-wrapper">
        <!-- TARGET CAPTURE ELEMENT -->
        <div id="poster-ratio-box" class="ratio-box">
            <!-- Content wrapper inside the ratio box -->
            <div id="poster-content">
                
                <!-- HEADER SECTION -->
                <header class="header-bg shadow-xl mb-5 md:mb-7 internal-padding">
                    <div class="text-center text-[#003B46]">
                        <!-- TOP BAR: Logos and Map Image -->
                        <div class="flex flex-col md:flex-row justify-between items-center mb-5 max-w-5xl mx-auto">
                            <!-- Logo Image Embed -->
                            <div class="text-xs font-semibold text-[#07575B] mb-3 md:mb-0">
                                <img src="https://res.cloudinary.com/djexglfns/image/upload/v1760247585/logo_mitra-removebg-preview_adxkpk.png" 
                                     alt="Logo Mitra Proyek: Global Fund, JIP, Kemenkes" 
                                     class="h-10 md:h-12 w-auto object-contain">
                            </div>
                            <!-- Map Image Embed -->
                            <div class="w-16 h-16 md:w-20 md:h-20 rounded-full flex items-center justify-center border-3 border-[#07575B] flex-shrink-0 overflow-hidden">
                                <img src="https://placehold.co/100x100/FFFFFF/003B46?text=Map+ID" 
                                     alt="Peta Indonesia dengan 4 lokasi proyek" 
                                     class="w-full h-full object-cover">
                            </div>
                        </div>
                        
                        <h1 class="text-2xl md:text-4xl lg:text-5xl font-black uppercase tracking-tight leading-snug">
                            COPPER: THE POWER OF INCLUSION
                        </h1>
                        <h2 class="text-sm md:text-base font-semibold mt-3 text-[#07575B] max-w-4xl mx-auto">
                            Community-Led Inclusive Pandemic Preparedness and Response (PPR) in Indonesia.
                        </h2>
                    </div>
                </header>

                <main class="internal-padding pt-0">
                    
                    <!-- --- ROW 1: CONTEXT & JOURNEY (2 COLUMNS: 1/3 vs 2/3) --- -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-5 mb-6 md:mb-8">

                        <!-- COLUMN 1 (1/3 WIDTH): CONTEXT & SITES -->
                        <div class="md:col-span-1 space-y-4">
                            
                            <!-- Project Objective -->
                            <section class="p-3 bg-white rounded-xl shadow-lg border-t-3 border-[#003B46]">
                                <h3 class="text-base font-bold mb-2 text-[#003B46]">Project Objective</h3>
                                <p class="text-xs text-gray-700 leading-tight">
                                    To **strengthen Indonesia's national PPR framework** by integrating rights-based, gender-responsive, and community-led health mechanisms, focusing on the most excluded populations: **Ex-Prisoners** and **Key Populations (HTM)**.
                                </p>
                            </section>

                            <!-- Project Sites & Local Leadership -->
                            <section class="p-3 bg-[#07575B] text-white rounded-xl shadow-lg border-t-3 border-[#F7B733]">
                                <h3 class="text-base font-bold mb-2 text-[#C4DFE6]"><i class="fas fa-location-dot mr-2"></i>Project Sites</h3>
                                <div class="grid grid-cols-2 gap-2 text-xs font-semibold">
                                    <div class="p-1 border border-[#66A5AD] rounded-lg text-center bg-[#003B46]/70">Bandung</div>
                                    <div class="p-1 border border-[#66A5AD] rounded-lg text-center bg-[#003B46]/70">Makassar</div>
                                    <div class="p-1 border border-[#66A5AD] rounded-lg text-center bg-[#003B46]/70">Medan</div>
                                    <div class="p-1 border border-[#66A5AD] rounded-lg text-center bg-[#003B46]/70">Surabaya</div>
                                </div>
                            </section>

                            <!-- Rationale/Background -->
                            <section class="p-3 bg-white rounded-xl shadow-lg border-t-3 border-[#66A5AD]">
                                <h3 class="text-base font-bold mb-2 text-[#003B46]">The Rationale</h3>
                                <p class="text-xs text-gray-700 leading-tight">
                                    Health crises disproportionately affect vulnerable groups due to systemic barriers, stigma, and lack of accessible services. COPPER tackles this by validating **community experience as evidence** for policy change, making PPR truly equitable.
                                </p>
                            </section>
                        </div>

                        <!-- COLUMN 2 (2/3 WIDTH): IMPLEMENTATION JOURNEY & VOICE -->
                        <div class="md:col-span-2 space-y-4">
                            
                            <!-- Implementation Journey (VERTICAL FLOW WITH IMAGES) -->
                            <section class="p-4 bg-white rounded-xl shadow-lg border-t-3 border-[#F7B733]">
                                <h3 class="text-base font-bold mb-3 text-[#003B46] text-center">Implementation Journey</h3>
                                
                                <div class="grid grid-cols-2 md:grid-cols-4 gap-3 text-center">
                                    
                                    <!-- Step 1: Capacity Building -->
                                    <div class="p-2 border border-gray-100 rounded-lg">
                                        <div class="flex flex-col items-center">
                                            <div class="flow-circle c1 mb-2">1</div>
                                            <p class="font-bold text-xs mb-1 text-[#07575B] leading-tight">Capacity Building</p>
                                            <p class="text-[0.65rem] text-gray-600 leading-none mb-2">PPR literacy and HR training (35 leaders).</p>
                                        </div>
                                        <img src="https://placehold.co/150x60/C4DFE6/003B46?text=Capacity" alt="Foto kegiatan Capacity Building" class="w-full rounded-lg h-auto object-cover">
                                    </div>

                                    <!-- Step 2: Evidence Gathering -->
                                    <div class="p-2 border border-gray-100 rounded-lg">
                                        <div class="flex flex-col items-center">
                                            <div class="flow-circle c2 mb-2">2</div>
                                            <p class="font-bold text-xs mb-1 text-[#07575B] leading-tight">Evidence Gathering</p>
                                            <p class="text-[0.65rem] text-gray-600 leading-none mb-2">Lived experience data & Joint Advocacy Agenda.</p>
                                        </div>
                                        <img src="https://placehold.co/150x60/66A5AD/003B46?text=Evidence" alt="Foto kegiatan Evidence Gathering" class="w-full rounded-lg h-auto object-cover">
                                    </div>
                                    
                                    <!-- Step 3: Coordination -->
                                    <div class="p-2 border border-gray-100 rounded-lg">
                                        <div class="flex flex-col items-center">
                                            <div class="flow-circle c3 mb-2">3</div>
                                            <p class="font-bold text-xs mb-1 text-[#07575B] leading-tight">Coordination</p>
                                            <p class="text-[0.65rem] text-gray-600 leading-none mb-2">4 regional multi-sector Task Force formations.</p>
                                        </div>
                                        <img src="https://placehold.co/150x60/07575B/FFFFFF?text=Coordination" alt="Foto kegiatan Coordination" class="w-full rounded-lg h-auto object-cover">
                                    </div>
                                    
                                    <!-- Step 4: Policy Influence -->
                                    <div class="p-2 border border-gray-100 rounded-lg">
                                        <div class="flex flex-col items-center">
                                            <div class="flow-circle c4 mb-2">4</div>
                                            <p class="font-bold text-xs mb-1 text-[#07575B] leading-tight">Policy Influence</p>
                                            <p class="text-[0.65rem] text-gray-600 leading-none mb-2">National/Local policy integration & dialogue.</p>
                                        </div>
                                        <img src="https://placehold.co/150x60/F7B733/003B46?text=Policy" alt="Foto kegiatan Policy Influence" class="w-full rounded-lg h-auto object-cover">
                                    </div>

                                </div>
                            </section>

                            <!-- Voices from the Field -->
                            <section class="p-3 bg-[#003B46] text-white rounded-xl shadow-lg">
                                <h3 class="text-base font-bold mb-2 text-[#C4DFE6]"><i class="fas fa-comments mr-2"></i>Voices from the Field</h3>
                                <div class="quote-box">
                                    <p class="italic text-sm leading-snug">
                                        ‚ÄúBefore COPPER, kami merasa tidak terlihat dalam diskusi kesehatan masyarakat. Sekarang, kami adalah bagian dari solusi.‚Äù
                                    </p>
                                    <cite class="block text-right mt-2 text-xs font-semibold text-[#F7B733]">
                                        ‚Äî Leader Komunitas Eks-Tahanan, Bandung
                                    </cite>
                                </div>
                            </section>

                        </div>
                    </div>
                    <!-- --- END ROW 1 --- -->


                    <!-- --- ROW 2: RESULTS, CHALLENGES & LESSONS (3 EQUAL COLUMNS) --- -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-5 mb-6 md:mb-8">

                        <!-- COLUMN 3 (1/3 WIDTH): QUANTITATIVE RESULTS -->
                        <div class="md:col-span-1 space-y-4">
                            
                            <!-- Quantitative Results (Expanded Metrics) -->
                            <section class="p-3 bg-white rounded-xl shadow-lg border-t-3 border-[#07575B] h-full">
                                <h3 class="text-base font-bold mb-3 text-[#003B46] text-center">Key Quantitative Impacts</h3>
                                <div class="grid grid-cols-2 gap-2 text-center">
                                    <div class="p-2 bg-[#07575B] text-white rounded-lg">
                                        <div class="text-2xl font-black">80+</div>
                                        <p class="text-xs leading-none">Community Members Directly Engaged</p>
                                    </div>
                                    <div class="p-2 bg-[#66A5AD] text-[#003B46] rounded-lg">
                                        <div class="text-2xl font-black">4</div>
                                        <p class="text-xs leading-none">Regional Task Forces Established</p>
                                    </div>
                                    <div class="p-2 bg-[#F7B733] text-[#003B46] rounded-lg">
                                        <div class="text-2xl font-black">2</div>
                                        <p class="text-xs leading-none">National Policy Dialogues</p>
                                    </div>
                                    <div class="p-2 bg-[#003B46] text-white rounded-lg">
                                        <div class="text-2xl font-black">100%</div>
                                        <p class="text-xs leading-none">Local Authority Sign-off on Recommendations</p>
                                    </div>
                                </div>
                            </section>

                        </div>

                        <!-- COLUMN 4 (1/3 WIDTH): QUALITATIVE & CHALLENGES -->
                        <div class="md:col-span-1 space-y-4">
                            <!-- Qualitative Outcomes -->
                            <section class="p-3 bg-[#C4DFE6]/50 rounded-xl shadow-lg border-t-3 border-[#07575B]">
                                <h3 class="text-base font-bold mb-2 text-[#003B46]">Qualitative Outcomes</h3>
                                <div class="space-y-2">
                                    <div class="flex items-start">
                                        <div class="text-lg mr-3 text-[#07575B] flex-shrink-0"><i class="fas fa-handshake"></i></div>
                                        <p class="text-xs text-gray-700 leading-tight">Increased trust and formalized communication channels between community leaders and local health services.</p>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="text-lg mr-3 text-[#07575B] flex-shrink-0"><i class="fas fa-scroll"></i></div>
                                        <p class="text-xs text-gray-700 leading-tight">Recommendations submitted led to broader recognition of key populations in regional health system reform planning.</p>
                                    </div>
                                </div>
                            </section>
                            
                            <!-- Key Challenges -->
                            <section class="p-3 bg-white rounded-xl shadow-lg border-t-3 border-[#07575B]">
                                <h3 class="text-base font-bold mb-2 text-[#003B46]"><i class="fas fa-triangle-exclamation mr-2"></i>Key Challenges</h3>
                                <ul class="space-y-1 text-xs text-gray-700 list-disc list-inside ml-2">
                                    <li>**Stigma & Trust Deficit:** Initial reluctance from local authorities to engage excluded groups.</li>
                                    <li>**Funding Disconnect:** Difficulty in channeling sustainable, non-project-based funding directly to community-based PPR initiatives.</li>
                                </ul>
                            </section>

                        </div>

                        <!-- COLUMN 5 (1/3 WIDTH): LESSONS & RECOMMENDATIONS -->
                        <div class="md:col-span-1 space-y-4">
                            
                             <!-- Lessons Learned -->
                            <section class="p-3 bg-white rounded-xl shadow-lg border-t-3 border-[#66A5AD]">
                                <h3 class="text-base font-bold mb-3 text-[#003B46]"><i class="fas fa-book-open-reader mr-2"></i>Lessons Learned</h3>
                                <div class="space-y-2">
                                    <div class="flex items-start">
                                        <div class="text-xl mr-3 text-[#F7B733] font-black flex-shrink-0">1.</div>
                                        <div>
                                            <p class="font-bold text-sm text-[#07575B] leading-snug">Inclusion as a Core Resilience Factor</p>
                                            <p class="text-xs text-gray-600 leading-tight">Community leadership builds responsive systems that are sustainable and reach the 'last mile' populations effectively.</p>
                                        </div>
                                    </div>
                                    <div class="flex items-start">
                                        <div class="text-xl mr-3 text-[#66A5AD] font-black flex-shrink-0">2.</div>
                                        <div>
                                            <p class="font-bold text-sm text-[#07575B] leading-snug">Documentation is Paramount</p>
                                            <p class="text-xs text-gray-600 leading-tight">Detailed evidence and policy briefs are non-negotiable for successful, technically accepted advocacy.</p>
                                        </div>
                                    </div>
                                </div>
                            </section>

                            <!-- Moving Forward (Recommendations) -->
                            <section class="p-3 bg-[#07575B] text-white rounded-xl shadow-xl border-t-3 border-[#F7B733] h-full">
                                <h3 class="text-base font-bold mb-3 text-[#C4DFE6]"><i class="fas fa-arrow-up-right-dots mr-2"></i>Moving Forward</h3>
                                <div class="space-y-2">
                                    <div class="flex items-start p-1 bg-[#003B46]/70 rounded-lg">
                                        <div class="text-xl mr-3 flex-shrink-0">‚è´</div>
                                        <p class="text-xs leading-snug">Mandate the integration of community PPR groups into local public health emergency action plans.</p>
                                    </div>
                                    <div class="flex items-start p-1 bg-[#003B46]/70 rounded-lg">
                                        <div class="text-xl mr-3 flex-shrink-0">üí∞</div>
                                        <p class="text-xs leading-snug">Establish dedicated, flexible funding mechanisms for community PPR capacity maintenance.</p>
                                    </div>
                                    <div class="flex items-start p-1 bg-[#003B46]/70 rounded-lg">
                                        <div class="text-xl mr-3 flex-shrink-0">ü§ù</div>
                                        <p class="text-xs leading-snug">Expand the COPPER model to 5 new regions across Eastern Indonesia for greater national coverage.</p>
                                    </div>
                                </div>
                            </section>

                        </div>
                    </div>
                    <!-- --- END ROW 2 --- -->

                </main>

                <!-- FOOTER -->
                <footer class="text-center py-3 mt-5 border-t-3 border-[#66A5AD] bg-white internal-padding pt-3 pb-5">
                    <div class="text-xs text-[#003B46] ">
                        <p class="font-semibold mb-2">Implemented by JIP, Supported by The Global Fund</p>
                        <div class="flex flex-col sm:flex-row justify-center items-center space-y-2 sm:space-y-0 sm:space-x-6">
                            <div class="text-[0.7rem] text-gray-600">
                                <p>Contact: JIP Secretariat | info@jip-indonesia.org</p>
                            </div>
                            <div class="flex items-center space-x-2 p-1 border border-[#07575B] rounded-lg bg-gray-50">
                                <div class="w-7 h-7 bg-gray-200 flex items-center justify-center rounded-md">
                                    <i class="fas fa-qrcode text-base text-[#07575B]"></i>
                                </div>
                                <span class="font-bold text-[#003B46] text-xs">Scan for Full Report</span>
                            </div>
                        </div>
                        <div class="mt-3 text-xs font-medium text-gray-600 space-x-2">
                            <span>#CommunityLedPPR</span>
                            <span>#LeaveNoOneBehind</span>
                            <span>#COPPERIndonesia</span>
                        </div>
                    </div>
                </footer>
            </div>
            <!-- END: poster-content -->
        </div>
        <!-- END: poster-ratio-box -->
    </div>
    <!-- END: poster-wrapper -->

    <!-- DOWNLOAD BUTTON (Excluded from the capture) -->
    <div id="download-btn-container" class="mx-auto text-center py-6 px-4 max-w-[900px] w-full">
        <button id="download-btn" onclick="downloadPoster()" 
                class="bg-[#F7B733] hover:bg-[#ffc950] text-[#003B46] font-extrabold py-3 px-8 rounded-full shadow-xl transition duration-300 transform hover:scale-[1.02] active:scale-95 text-lg flex items-center justify-center mx-auto">
            <i class="fas fa-download mr-3"></i> Download Poster (PNG, 60x90 cm High-Res)
        </button>
        <p class="text-xs mt-3 text-gray-500">
            File PNG akan menangkap **semua konten** dengan resolusi tinggi (5x skala) agar ideal untuk cetak 60x90 cm.
        </p>
    </div>

    <script>
        // Fungsi untuk menunggu semua gambar di dalam elemen dimuat
        function waitAllImagesLoaded(element) {
            const images = element.querySelectorAll('img');
            const promises = [];

            images.forEach(img => {
                if (img.complete && img.naturalHeight !== 0) {
                    // Gambar sudah dimuat dan memiliki dimensi, tidak perlu menunggu
                    return;
                }
                
                // Buat Promise untuk menunggu event 'load' atau 'error'
                promises.push(new Promise(resolve => {
                    img.onload = resolve;
                    img.onerror = resolve; // Lanjutkan meskipun ada gambar yang gagal dimuat
                }));
            });

            return Promise.all(promises);
        }

        /**
         * Function to download the main poster content as a PNG image, 
         * capturing the full height of the content at high resolution (5x scale).
         */
        async function downloadPoster() {
            const contentToCapture = document.getElementById('poster-ratio-box'); 
            const contentInner = document.getElementById('poster-content'); 
            const outerWrapper = document.getElementById('poster-wrapper-id');
            const downloadButtonContainer = document.getElementById('download-btn-container');
            const loadingIndicator = document.getElementById('loading-indicator');

            // Tampilkan indikator loading
            loadingIndicator.style.display = 'flex';
            
            // Simpan state asli dari style yang akan dimodifikasi
            const originalStyles = {
                ratioBoxPadding: contentToCapture.style.paddingBottom, 
                contentPosition: contentInner.style.position,
                contentHeight: contentInner.style.height,
                contentOverflow: contentInner.style.overflowY || 'auto',
                outerMargin: outerWrapper.style.margin,
                outerBoxShadow: outerWrapper.style.boxShadow,
            };

            try {
                // Tunggu semua gambar dimuat (termasuk logo)
                await waitAllImagesLoaded(contentInner);

                // 2. Persiapan UI & Modifikasi Style (Membuat Konten Mengalir Penuh)
                downloadButtonContainer.style.display = 'none';
                outerWrapper.style.margin = '0'; 
                outerWrapper.style.boxShadow = 'none'; 
                
                // Hapus pembatasan rasio (memaksa box mengambil tinggi penuh)
                contentToCapture.style.paddingBottom = '0'; 

                // Izinkan konten dalam untuk mengalir penuh dan nonaktifkan scrolling
                contentInner.style.position = 'relative'; 
                contentInner.style.height = 'auto'; 
                contentInner.style.overflowY = 'hidden'; 
                
                // Memberi waktu untuk reflow DOM (pembaruan tata letak) agar tinggi penuh dihitung
                await new Promise(r => setTimeout(r, 200)); 

                // 3. Panggil html2canvas
                const canvas = await html2canvas(contentToCapture, {
                    scale: 5, // SANGAT PENTING: Menggunakan skala 5x untuk resolusi cetak yang sangat tinggi
                    useCORS: true, 
                    allowTaint: true,
                    backgroundColor: '#F0F4F8', 
                    scrollX: 0,
                    scrollY: 0,
                });

                // 4. Kembalikan semua style ke kondisi semula (Restore Visual Ratio 60:90)
                contentToCapture.style.paddingBottom = originalStyles.ratioBoxPadding;
                contentInner.style.position = originalStyles.contentPosition;
                contentInner.style.height = originalStyles.contentHeight;
                contentInner.style.overflowY = originalStyles.contentOverflow;
                outerWrapper.style.margin = originalStyles.outerMargin; 
                outerWrapper.style.boxShadow = originalStyles.outerBoxShadow; 
                downloadButtonContainer.style.display = 'block';
                loadingIndicator.style.display = 'none'; // Sembunyikan loading

                // 5. Picu Download
                const link = document.createElement('a');
                // Beri nama file yang mencerminkan resolusi tinggi 60x90 cm
                link.download = 'COPPER_Poster_60x90cm_High_Res.png';
                link.href = canvas.toDataURL('image/png');
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);

            } catch (error) {
                console.error("Error generating PNG:", error);
                
                // Pastikan style dikembalikan meskipun ada error
                contentToCapture.style.paddingBottom = originalStyles.ratioBoxPadding;
                contentInner.style.position = originalStyles.contentPosition;
                contentInner.style.height = originalStyles.contentHeight;
                contentInner.style.overflowY = originalStyles.contentOverflow;
                outerWrapper.style.margin = originalStyles.outerMargin; 
                outerWrapper.style.boxShadow = originalStyles.outerBoxShadow; 
                downloadButtonContainer.style.display = 'block';
                loadingIndicator.style.display = 'none';

                const errorDiv = document.createElement('div');
                errorDiv.textContent = 'Gagal membuat file PNG. Silakan coba lagi.';
                errorDiv.className = 'fixed top-5 right-5 p-3 bg-red-600 text-white font-semibold rounded-lg shadow-xl z-50';
                document.body.appendChild(errorDiv);
                setTimeout(() => document.body.removeChild(errorDiv), 6000);
            }
        }
    </script>
</body>
</html>
